<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>PDF arrastável + hitboxes (sem controles visíveis)</title>
<style>
  html,body{height:100%;margin:0;background:#111;color:#eee;font-family:Arial}
  #viewer{position:fixed;inset:0;display:flex;align-items:center;justify-content:center}
  #canvasContainer{position:relative;width:100%;height:100%;overflow:auto;background:#222;touch-action:none}
  canvas{background:#fff;display:block;user-select:none;-webkit-user-drag:none}
  .hitbox{position:absolute;background:transparent;cursor:pointer;z-index:50}
  /* REMOVA/COMENTE a linha abaixo se você quiser os botões visíveis */
  #controls{display:none!important}
  /* pequeno contador discreto */
  #pageInfo{position:fixed;right:12px;bottom:12px;background:rgba(0,0,0,0.45);padding:6px 8px;border-radius:6px;font-size:13px}
</style>
</head>
<body>

<div id="viewer">
  <div id="canvasContainer">
    <canvas id="pdfCanvas"></canvas>
  </div>
</div>
<div id="pageInfo">Carregando…</div>

<!-- PDF.js -->
<script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.6.172/build/pdf.min.js"></script>
<script>
const pdfUrl = 'meu.pdf'; // coloque aqui seu PDF na mesma pasta
const hitboxesPerPage = { 1: [ { left:10, top:70, width:20, height:8, type:'link', href:'https://youtube.com' } ] };

const pdfjsLib = window['pdfjs-dist/build/pdf'];
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.6.172/build/pdf.worker.min.js';

const canvas = document.getElementById('pdfCanvas');
const ctx = canvas.getContext('2d');
const container = document.getElementById('canvasContainer');
const pageInfo = document.getElementById('pageInfo');

let pdfDoc=null, pageNum=1, scale=1, fitToScreen=true;

async function loadPdf(){
  pdfDoc = await pdfjsLib.getDocument(pdfUrl).promise;
  renderPage(pageNum);
}

async function renderPage(num){
  const page = await pdfDoc.getPage(num);
  const viewport = page.getViewport({ scale:1 });
  const cW = container.clientWidth || window.innerWidth;
  const cH = container.clientHeight || window.innerHeight;
  let targetScale = fitToScreen ? Math.min(cW/viewport.width, cH/viewport.height) : scale;
  const renderViewport = page.getViewport({ scale: targetScale });
  canvas.width = Math.floor(renderViewport.width);
  canvas.height = Math.floor(renderViewport.height);
  await page.render({ canvasContext: ctx, viewport: renderViewport }).promise;
  canvas.style.width = canvas.width + 'px';
  canvas.style.height = canvas.height + 'px';
  scale = targetScale;
  placeHitboxes(num);
  pageInfo.textContent = `Página ${pageNum} / ${pdfDoc.numPages} — ${(scale*100).toFixed(0)}%`;
}

function clearHitboxes(){ container.querySelectorAll('.hitbox').forEach(n=>n.remove()); }

function placeHitboxes(p){
  clearHitboxes();
  (hitboxesPerPage[p]||[]).forEach(h=>{
    const el = document.createElement(h.type==='link' ? 'a' : 'div');
    el.className = 'hitbox';
    if(h.type==='link'){ el.href=h.href; el.target='_blank'; el.rel='noopener'; }
    el.style.left = h.left + '%';
    el.style.top = h.top + '%';
    el.style.width = h.width + '%';
    el.style.height = h.height + '%';
    container.appendChild(el);
  });
}

/* Navegação por teclado (sem controles visíveis) */
window.addEventListener('keydown', (e)=>{
  if(!pdfDoc) return;
  if(e.key === 'ArrowRight'){ if(pageNum < pdfDoc.numPages){ pageNum++; fitToScreen=false; renderPage(pageNum); } }
  if(e.key === 'ArrowLeft'){ if(pageNum > 1){ pageNum--; fitToScreen=false; renderPage(pageNum); } }
  if(e.key === '+' || e.key === '='){ fitToScreen=false; scale *= 1.2; renderPage(pageNum); }
  if(e.key === '-') { fitToScreen=false; scale /= 1.2; renderPage(pageNum); }
});

/* Drag para pan (pointer events) */
let isPointerDown=false, startX=0, startY=0, sLeft=0, sTop=0, dragMoved=false;
container.addEventListener('pointerdown', e => { isPointerDown=true; container.setPointerCapture(e.pointerId); startX=e.clientX; startY=e.clientY; sLeft=container.scrollLeft; sTop=container.scrollTop; dragMoved=false; });
container.addEventListener('pointermove', e => { if(!isPointerDown) return; const dx=e.clientX-startX, dy=e.clientY-startY; if(Math.abs(dx)>4||Math.abs(dy)>4) dragMoved=true; container.scrollLeft = sLeft - dx; container.scrollTop = sTop - dy; });
container.addEventListener('pointerup', e=>{ if(isPointerDown){ isPointerDown=false; try{container.releasePointerCapture(e.pointerId)}catch(_){} } });

window.addEventListener('resize', ()=> { if(!pdfDoc) return; setTimeout(()=>renderPage(pageNum),120); });

loadPdf().catch(err=>{ console.error(err); pageInfo.textContent = 'Erro ao carregar PDF (CORS ou arquivo não encontrado)'; });
</script>
</body>
</html>
